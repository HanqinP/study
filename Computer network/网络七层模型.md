# 网络

网络是由一组具有通讯功能的设备（主机，交换机，路由器等）相连而形成的。

## 局域网



局域网（local area network）通常是私有的。连接一个办公室，大楼或者校园网。在过去一个网络上的所有电脑都连接在一根公共电缆上，这导致了当一个电脑发送一个包给另一个时，其他电脑都要被迫接受选择抛弃。之后有了交换机后交换机可以智能的选择包要去的目的地址从而减轻了局域网中的流量。

![局域网连接图](file:///Users/hanqinpeng/Desktop/github/study/Computer%20network/img/%E5%B1%80%E5%9F%9F%E7%BD%91%E8%BF%9E%E6%8E%A5%E5%9B%BE.jpg?lastModify=1623938735)



## 广域网

广域网相比于局域网可以有更多的地理位置的覆盖，可以是一个城市，一个省乃至一个国家。局域网互联主机，广域网互联交换机，路由器，调制解调器等设备。局域网通常由使用它的组织拥有；广域网通常由电信公司持有。

### 点到点广域网

点到点广域网通过传输介质连接两台设备。

### 交换式广域网

交换式广域网是交换机连接几个点到点的广域网形成的。

## 互联网络

多个网络连接起来就形成了互联网。如图：

![两个局域网和一个点对点广域网形成的互联网](file:///Users/hanqinpeng/Desktop/github/study/Computer%20network/img/%E4%BA%92%E8%81%94%E7%BD%91%E7%BB%9C%E4%BE%8B%E5%9B%BE1.jpg?lastModify=1623938735)



# 网络体系结构



## TCP/IP

所谓协议（protocol），其实就是一个群体之间规定的规则，这个规则的目的是为了保证这个群体里面的人可以正常交流。还是回到计算机和网络的通信这边来举例。比如： 如何探测到通信目标、由哪一边先发起通信、使用哪种语言进行通信、怎样结束通信等规则都需要事先确定。不同的硬件、操作系统之间的通信，所有的这一切都需要一种规则。

协议中存在各式各样的内容。从电缆的规格到 IP 地址的选定方法、寻找异地用户的方法、双方建立通信的顺序，以及 Web 页面显示需要处理的步骤，等等。

像这样把与互联网相关联的协议集合起来总称为 TCP/IP。也有说法认为，TCP/IP 是指 TCP 和 IP 这两种协议。还有一种说法认为，TCP/IP 是在 IP 协议的通信过程中，使用到的协议族的统称。

## 层次化结构

为了展示如何利用TCP/IP协议簇进行两台主机的通讯，假设将协议簇用在一个由三个局域网链接组成的小型互联网。每个局域网有个链路层交换机，同时假设局域网连接到一个路由器。如图：

![层次结构图](./img/层次结构图.jpg)

（链路：LAN/WAN）

假设主机A正与主机B进行通讯，在这个通讯过程中涉及5个通讯设备：主机A，链路1，路由器，链路2，主机B。按照设备在互联网中扮演的角色不同，每一台设备包含了几个层次。

两台主机包含了5个层次；源主机A需要在应用层创建一个信息并把他送到下层以便信息在物理层传输给主机B。目标主机需要在物理层接收这个信息然后在依靠其他上面的层把信息传递到应用层。

路由器涉及了三个层次；只要路由器只做路由选择，路由器中就没有传输层或应用层。虽然一个路由器总有一个网络层，但他涉及n个物理层和数据链路层的组合，其中n为路由器连接链路的数目。其主要原因是每条链路可以使用它自己的链路或物理层。





## OSI七层模型，TCP/IP五层协议/四层协议

OSI(Open System Interconnection System)是由国际化标准组织提出的概念模型，试图使各种不同的计算机和网络实现互联。

![网络体系结构](./img/网络体系结构图.webp)



![传递对象和服务协议](./img/七层对应协议和传输数据类型.gif)

### 物理层

该层为上层协议提供可靠的数据传输的物理媒体，也就是物理层确保数据可在各物理媒介中传输。（中继器和放大器是两个重要设备在物理层）

### 数据链路层

数据链路层在物理层提供的服务的基础上向网络层提供服务，其最基本的服务是将源自网络层来的数据可靠地传输到相邻节点的目标机网络层。为达到这一目的，数据链路必须具备一系列相应的功能，主要有：如何将数据组合成数据块，在数据链路层中称这种数据块为帧（frame），帧是数据链路层的传送单位；如何控制帧在物理信道上的传输，包括如何处理传输差错，如何调节发送速率以使与接收方相匹配；以及在两个网络实体之间提供数据链路通路的建立、维持和释放的管理。数据链路层在不可靠的物理介质上提供可靠的传输。该层的作用包括：物理地址寻址、数据的成帧、流量控制、数据的检错、重发等。

数据链路层为网络层提供可靠的数据传输

- 基本数据单位为帧

- 主要的协议：以太网协议

- 两个重要设备名称：网桥和交换机。

### 网络层

网络层的目的是实现两个端系统之间的数据透明传送，具体功能包括寻址和路由选择、连接的建立、保持和终止等。它提供的服务使传输层不需要了解网络中的数据传输和交换技术。如果您想用尽量少的词来记住网络层，那就是"路径选择、路由及逻辑寻址"。

网络层中涉及众多的协议，其中包括最重要的协议，也是TCP/IP的核心协议——IP协议。IP协议非常简单，仅仅提供不可靠、无连接的传送服务。IP协议的主要功能有：无连接数据报传输、数据报路由选择和差错控制。与IP协议配套使用实现其功能的还有地址解析协议ARP、逆地址解析协议RARP、因特网报文协议ICMP、因特网组管理协议IGMP。

- 网络层负责对子网间的数据包进行路由选择。此外，网络层还可以实现拥塞控制、网际互连等功能；

- 基本数据单位为IP数据报；
- 包含的主要协议：
- - IP协议（Internet Protocol，因特网互联协议）;
- - ICMP协议（Internet Control Message Protocol，因特网控制报文协议）;
- - ARP协议（Address Resolution Protocol，地址解析协议）;
- - RARP协议（Reverse Address Resolution Protocol，逆地址解析协议）。
- 重要的设备：路由器。

### 传输层 

第一个端到端，即主机到主机的层次。传输层负责将上层数据分段并提供端到端的、可靠的或不可靠的传输。此外，传输层还要处理端到端的差错控制和流量控制问题。 传输层的任务是根据通信子网的特性，最佳的利用网络资源，为两个端系统的会话层之间，提供建立、维护和取消传输连接的功能，负责端到端的可靠数据传输。在这一层，信息传送的协议数据单元称为段或报文。 网络层只是根据网络地址将源结点发出的数据包传送到目的结点，而传输层则负责将数据可靠地传送到相应的端口。 有关网络层的重点：

- 传输层负责将上层数据分段并提供端到端的、可靠的或不可靠的传输以及端到端的差错控制和流量控制问题；
-  包含的主要协议：TCP协议（Transmission Control Protocol，传输控制协议）、UDP协议（User Datagram Protocol，用户数据报协议）；
- 3> 重要设备：网关。

### 会话层

会话层管理主机之间的会话进程，即负责建立、管理、终止进程之间的会话。会话层还利用在数据中插入校验点来实现数据的同步。

### 表示层

表示层对上层数据或信息进行变换以保证一个主机应用层信息可以被另一个主机的应用程序理解。表示层的数据转换包括数据的加密、压缩、格式转换等。

### 应用层

为操作系统或网络应用程序提供访问网络服务的接口。

会话层、表示层和应用层重点：

- 数据传输基本单位为报文；
- 包含的主要协议：FTP（文件传送协议）、Telnet（远程登录协议）、DNS（域名解析协议）、SMTP（邮件传送协议），POP3协议（邮局协议），HTTP协议（Hyper Text Transfer Protocol）。

## 封装和解装

在Internet分层协议中，分装和解装是一个重要概念，如图显示了小型互联网的封装和解装过程：

![封装解装](./img/封装解装.jpg)



Note：由于在链路层交换机中没有封装解装过程，所以没有显示链路交换机的层次。

